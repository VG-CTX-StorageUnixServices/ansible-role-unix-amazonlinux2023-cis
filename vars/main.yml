---

min_ansible_version: 2.10.1
amzn2023cis_allowed_crypto_policies:
    - 'DEFAULT'
    - 'FUTURE'
    - 'FIPS'

amzn2023cis_allowed_crypto_policies_modules:
    - 'OSPP'
    - 'AD-SUPPORT'
    - 'AD-SUPPORT-LEGACY'

# Used to control warning summary
warn_control_list: ""
warn_count: 0

gpg_key_package: "system-release"

os_gpg_key_pubkey_name: gpg-pubkey-d832c631-6515c85e  # pragma: allowlist secret
os_gpg_key_pubkey_content: "Amazon Linux <amazon-linux@amazon.com> d832c631"

# Centex config
amzn2023cis_rule_1_2_4: false
amzn2023cis_rule_6_2_10: false # mounts do not have option acl
run_audit: false

amzn2023cis_warning_banner: |
    |-----------------------------------------------------------------|
    | This system is for the use of authorized users only.            |
    | Individuals using this computer system without authority, or in |
    | excess of their authority, are subject to having all of their   |
    | activities on this system monitored and recorded by system      |
    | personnel.                                                      |
    |                                                                 |
    | In the course of monitoring individuals improperly using this   |
    | system, or in the course of system maintenance, the activities  |
    | of authorized users may also be monitored.                      |
    |                                                                 |
    | Anyone using this system expressly consents to such monitoring  |
    | and is advised that if such monitoring reveals possible         |
    | evidence of criminal activity, system personnel may provide the |
    | evidence of such monitoring to law enforcement officials.       |
    |-----------------------------------------------------------------|

amzn2023cis_motd_banner: Message of the Day is blank

amzn2023cis_auditd:
    # This variable tells the system what action to take when the system has detected
    # that it is starting to get low on disk space.
    # The options for setting this variable are as follows:
    # "ignore"  - the system does nothing when presented with the aforementioned issue;
    # "syslog" - a message is sent to the system log about disk space running low;
    # "email"  - the system sends an email notification to the email address
    #            specified in the "action_mail_acct" variable;
    # "exec"   - the system executes a custom command when disk space is running
    #            low;
    # "suspend" - the system suspends recording audit events until more space is available;
    # "single"  - the audit daemon will put the computer system in single user mode;
    # "halt"    - the system is halted when disk space is critically low;
    space_left_action: email
    # This variable specifies an e-mail address or alias to which any alert messages
    # should be sent. The default setting is root, but you can enter any local or
    # remote account as long as e-mail and the network are properly configured on
    # your system and /usr/lib/sendmail exists.
    action_mail_acct: root
    # This variable tells the system what action to take when the system has detected
    # that it is low on disk space.
    # The options for setting this variable are as follows:
    # "ignore"  - the system does nothing when presented with the aforementioned issue;
    # "syslog"  - a message is sent to the system log about disk space running low;
    # "email"  - the system sends an email notification to the email address
    #            specified in the "action_mail_acct" variable;
    # "exec"   - the system executes a custom command when disk space is running
    #            low;
    # "suspend" - the system suspends recording audit events until more space is available;
    # "single"  - the audit daemon will put the computer system in single user mode;
    # "halt"    - the system is halted when disk space is critically low;
    # CIS prescribes either `halt` or `single`.
    admin_space_left_action: single
    # This variable determines what action the audit system should take when the maximum
    # size of a log file is reached.
    # The options for setting this variable are as follows:
    # "ignore"    - the system does nothing when the size of a log file is full;
    # "syslog"    - a message is sent to the system log indicating the problem;
    # "suspend"   - the system suspends recording audit events until the log file is cleared or rotated;
    # "rotate"    - the log file is rotated (archived) and a new empty log file is created;
    # "keep_logs" - the system attempts to keep as many logs as possible without violating disk
    #               space constraints;
    # CIS prescribes the value `keep_logs`.
    max_log_file_action: rotate


